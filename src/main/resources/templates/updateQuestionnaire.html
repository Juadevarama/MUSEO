<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
  	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

  	<head>

		<link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.0.0-2/css/bootstrap.min.css} "/>
		<link th:rel="stylesheet" th:href="@{/assets/jquery-steps/jquery.steps.css} "/>

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" 
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

		<meta charset="ISO-8859-1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>MUSEO: Update Questionnaire</title>

    </head>

    <body class="bg-secondary">

        <div class= "container-sm p-5 my-5 border rounded bg-dark bg-gradient text-white" style="width: 1600px;">

			<form th:action="@{/updateQuestionnaire}" method="POST" th:object="${questionnaire}">  

				<div th:switch="${user.role}">
					<div th:case="'Administrator'">

						<!-- Not all answered message -->
						<div th:if="${param.question}">
							<div class="alert alert-danger">Please choose at least one heuristic!</div>
						</div>

						<!-- Hidden Atributes -->
					
						<input type="hidden" th:field="*{id}" name="id" th:value="${id}">
						<input type="hidden" th:field="*{closed}" name="closed" th:value="${closed}"> 


						<div>
							<label class="form-label">Product name</label>
							<input type="text" th:field="*{product}" placeholder="Insert the product name">

							<label class="form-label">Description</label>
							<input type="text" class="flex-fill" th:field="*{description}" placeholder="Insert a description for the product">
						</div>

						<table class="table table-striped table-bordered table-hover table-dark">
							<thead>
								<th>These are the Heuristic you have choosen so far:</th>
							</thead>
							<tbody>
								<!-- FH que ya estaban seleccionadas -->
								<th:block th:each="heuristic : ${fHSelected}">
									<tr>
										<td>
											<input type="checkbox" name="choosenFH" th:value="${heuristic}" th:text="' ' + ${heuristic.heuristicString}" checked>
										</td>
									</tr>
								</th:block>
							<tbody>
						</table>

						<table class="table table-striped table-bordered table-hover table-dark">
							<thead>
								<th>The system recommends you these Heuristics:</th>
							</thead>
							<tbody>
							<!-- FH no seleccionadas pero automÃ¡ticas -->
								<th:block th:each="heuristic : ${fHAutomatic}">
									<tr>
										<td>
											<input type="checkbox" name="choosenFH" th:value="${heuristic}" th:text="' ' + ${heuristic.heuristicString}">
										</td>
									</tr>
								</th:block>
							<tbody>
						</table>

						<table class="table table-striped table-bordered table-hover table-dark">
							<thead>
								<th>Others Heuristics you may choose:</th>
							</thead>
							<tbody>
							<!-- Resto de FH -->
								<th:block th:each="heuristic : ${fHRemainder}">
									<tr>
										<td>
											<input type="checkbox" name="choosenFH" th:value="${heuristic}" th:text="' ' + ${heuristic.heuristicString}">
										</td>
									</tr>
								</th:block>
							<tbody>
						</table>
					</div>
					
					<div th:case="'Evaluator'">

						<!-- Not all answered message -->
						<div th:if="${param.answer}">
							<div class="alert alert-danger">You need to answer all the questions!</div>
						</div>
						<!-- Hidden Atributes -->
					
						<input type="hidden" th:field="*{id}" name="id" th:value="${id}">
						<input type="hidden" th:field="*{product}" name="product" th:value="${product}"> 
						<input type="hidden" th:field="*{description}" name="description" th:value="${description}"> 
						<input type="hidden" th:field="*{closed}" name="closed" th:value="${closed}"> 

						<div class="col-md-12">
							<div class="mb-6">
								<label class="form-label">Product name</label>
								<p type="text" th:text="*{product}">
							</div>
							<div class="mb-6">
								<label class="form-label">Description</label>
								<p type="text" th:text="*{description}"></p>                            
							</div>
						</div>                            
						<table class="table table-striped table-bordered table-hover table-dark">
							<thead>
								<th>These are the Heuristic you have to answer:</th>
							</thead>

							<tbody>
								<th>
									<tr th:each="element : ${auxMap}">                               
										<td>

											<input type="hidden" name="answerList" th:value="${element.value}">

											<div th:switch="${element.value.ansString}">
												<div th:case="'Yes'">
													<select name="answerAux" id="answerAux">
														<option value="">Choose an answer</option>
														<option value="Yes" selected>Yes</option>
														<option value="No">No</option>
														<option value="N.A">N/A</option>
													</select>
													<label th:text="'   ' + ${element.key.heuristicString}"></label>
												</div>
												<div th:case="'No'">
													<select name="answerAux" id="answerAux">
														<option value="">Choose an answer</option>
														<option value="Yes">Yes</option>
														<option value="No" selected>No</option>
														<option value="N.A">N/A</option>
													</select>
													<label th:text="'   ' + ${element.key.heuristicString}"></label>
												</div>
												<div th:case="'N.A'">
													<select name="answerAux" id="answerAux">
														<option value="">Choose an answer</option>
														<option value="Yes">Yes</option>
														<option value="No">No</option>
														<option value="N.A" selected>N/A</option>
													</select>
													<label th:text="'   ' + ${element.key.heuristicString}"></label>
												</div>
												<div th:case="*">
													<select name="answerAux" id="answerAux">
														<option value="" selected>Choose an answer</option>
														<option value="Yes">Yes</option>
														<option value="No">No</option>
														<option value="N.A">N/A</option>
													</select>
													<label th:text="'   ' + ${element.key.heuristicString}"></label>
												</div> 
											</div>
										</td>
									</tr>
								</th>
							<tbody>
						</table>
					</div>
				</div>

				<a type="button" class="btn btn-primary float-start" style="margin-right: 5px;" th:href="@{/questionnaireList}">Back</a>
				<button type="submit" class="btn btn-success" name="action" style="margin-right: 5px;" value="Save">Save changes</button>
				<button type="submit" class="btn btn-success float-end" name="action" style="margin-left: 5px;" value="Complete">Save changes and finish</button>					
			</form>
        </div>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" 
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    </body>
</html>
