<!DOCTYPE html>
<html lang="en" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head>

  <div th:replace="header :: myHeader"></div>

  <title>MUSE: Questionnaire List</title>

</head> 

<body>

  <br>
  <br>

  <div class= "container">
    <div class= "row">
      <div class="col-md-12" col-md-offset-3>

        <!-- Create success message -->
        <div th:if="${param.create}">
          <div class="alert alert-success">You've successfully created your questionnaire!</div>
        </div>

        <!-- Update success message -->
        <div th:if="${param.update}">
          <div class="alert alert-info">You've successfully changed your questionnaire!</div>
        </div>

        <h1> Questionnaire List</h1>
        <form th:action="@{/questionnaireList}" method="GET">  
          <div th:switch="${user.role}"> 
            <div th:case="'Administrator'">
              <table class="table table-striped table-bordered table-hover">
                <caption>List of questionnaires</caption>
                <thead>
                  <tr>
                    <th>Product name</th>
                    <th>Description</th>
                    <th>Completed</th>
                    <th>Edit/Show</th>
                    <th>Export</th>
                    <th>Delivery Management</th>
                  </tr>
                </thead>
                <tbody>
                  <th:block th:each="questionnaire : ${questionnaireList}">
                    <tr>
                      <td th:text="*{questionnaire.product}"></td>
                      <td th:text="*{questionnaire.description}"></td>
                      <td th:text="*{questionnaire.closed}"></td>
                      <div th:switch="${questionnaire.closed}">
                        <div th:case="${true}">
                          <td>
                            <a th:href="@{/showQuestionnaire(questionnaireId=${questionnaire.id})}">Show</a>
                          </td>
                          <td>
                            <a th:href="@{/exportToPDF(questionnaireId=${questionnaire.id})}">Export to PDF</a>
                          </td> 
                          <td>
                            <a th:href="@{/deliveryManagement(questionnaireId=${questionnaire.id})}">Delivery Management</a>
                          </td>
                        </div>
                        <div th:case="${false}">
                          <td>
                            <a th:href="@{/updateQuestionnaire(questionnaireId=${questionnaire.id})}">Edit</a>
                          </td>
                          <td>Complete the quesstionaire first</td> 
                          <td>Complete the quesstionaire first</td> 
                        </div>
                      </div>                         
                      </td>
                    </tr>
                    </th:block> 
                </tbody>
              </table>     
              <a type="button" class="btn btn-default" th:href="@{/createQuestionnaire}">Create new questionnaire</a> 
            </div>
            <div th:case="'Evaluator'">
              <table class="table table-striped table-bordered table-hover">
                <caption>List of questionnaires</caption>
                <thead>
                  <tr>
                    <th>Product name</th>
                    <th>Description</th>
                    <th>Fill out</th>
                    <th>Export</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <th:block th:each="questionnaire : ${questionnaireList}">
                        <td th:text="*{questionnaire.product}"></td>
                        <td th:text="*{questionnaire.description}"></td>
                      </th:block> 
                      <th:block th:each="hU : ${hUList}">
                        <div th:switch="${hU.filled}">
                          <div th:case="${false}">
                            <td>
                              <a th:href="@{/updateQuestionnaire(questionnaireId=${hU.questionnaireID})}">Fill Out</a>
                            </td>
                          </div>
                          <div th:case="${true}">
                            <td>
                              <a th:href="@{/showFilledQuestionnaire(questionnaireId=${hU.questionnaireID},ansForm=${true})}">Show</a>
                            </td>
                          </div> 
                        <td>
                          <a th:href="@{/exportToPDF(questionnaireId=${hU.questionnaireID})}">Export to PDF</a>
                        </td>
                      </th:block>                     
                    </tr>
                </tbody>
              </table> 
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</body>

</html>
